import pandas as pd
import numpy as np
import math

df = pd.DataFrame([['Anna', 32, 3],
                   ['Serg', 40, 5],
                   ['Mike', 38, 4],
                   ['Smith', 80, None]])
df.columns = ['name', 'age', 'expr']

print(df)
print(type(df))
print(df['name'])
print(df.iloc[0])
print(df.iloc[:3, :2])
print(df[:3])

df.index = df['name']
print(df)
print(df.loc['Serg':'Smith', ['age', 'expr']])

print('\n---info---\n')
print(df.info())
print(df.shape)
print(df.describe())

print(df.dropna())
print(df[(df['age'] > 35) & (df['expr'] > 4)])

df['age2'] = df['age'] ** 2
print(df)

df['gender'] = [0, 1, 1, 1]
print(df)

df['no_work'] = df['age'] - df['expr']
print(df)

#------- –î–ó-----------
print('------- –î–ó-----------')

'''–ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—Å—Å–∏–≤ NumPy –∏–∑ —Ñ–∞–π–ª–∞ "arr_pandas.npy" (–∫–∞–∫ –≤ –∑–∞–¥–∞–Ω–∏–∏ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –º–æ–¥—É–ª—é) –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º. 
–ú–∞—Å—Å–∏–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π Scottish Hill Races –≤ 2000 –≥–æ–¥—É (–ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ 
–º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –ø–æ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É —Å –¥–∞–Ω–Ω—ã–º–∏).'''
arr = np.load('arr_pandas.npy', allow_pickle=True)
dat = pd.DataFrame(arr)
print(dat)

'''–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å–∫–æ–ª—å–∫–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤. –ü—Ä–∏–≤–µ—Å—Ç–∏ –∫–æ–¥ –∏ —É–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ –∫–æ–¥—É.'''
print(dat.shape)

'''–ü—Ä–∏—Å–≤–æ–∏—Ç—å —Å—Ç–æ–ª–±—Ü–∞–º —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è (—É–∫–∞–∑–∞–Ω—ã —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏):

id: id —É—á–∞—Å—Ç–Ω–∏–∫–∞
dist: —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –º–∏–ª—è—Ö (–ø–æ –∫–∞—Ä—Ç–µ)
climb: –≤—ã—Å–æ—Ç–∞, –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞—è –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ (–≤ —Å—É–º–º–µ –∑–∞ –≤–µ—Å—å –º–∞—Ä—à—Ä—É—Ç, –≤ —Ñ—É—Ç–∞—Ö)
time: –≤—Ä–µ–º—è (–≤ —á–∞—Å–∞—Ö)
timef: –≤—Ä–µ–º—è –¥–ª—è –∂–µ–Ω—â–∏–Ω (–≤ —á–∞—Å–∞—Ö)
type: —Ç–∏–ø –≥–æ–Ω–∫–∏ (hill, marathon, relay, uphill or other)'''

dat.columns = ['id', 'dist', 'climb', 'time', 'timef', 'type']
print(dat)

'''–í—ã–≤–µ—Å—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã, –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–π –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–º Norman's Law.'''
print(int(dat[(dat['id'] == "Norman's Law")]['climb']))

'''–í—ã–≤–µ—Å—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π dist, climb , time –¥–ª—è –ø–µ—Ä–≤—ã—Ö 10 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤'''
print(dat.loc[:, ['dist', 'climb', 'time']].head(10))

'''–í—ã–≤–µ—Å—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω —Å–≤–æ–¥–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç —Ç–∏–ø—ã –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤. 
–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∏–ø–∞ float –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ? –ü—Ä–∏–≤–µ—Å—Ç–∏ –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ –∫–æ–¥—É.'''
print(dat.info())

'''–í—ã–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —ç—Å—Ç–∞—Ñ–µ—Ç—ã (relay).'''
print(dat[(dat['type'] == "relay")])

'''–í—ã–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –≥–æ–Ω–∫–∏ –≤ —Ö–æ–ª–º–∞—Ö (hill), –∫–æ—Ç–æ—Ä—ã–µ –≤ —Å—É–º–º–µ –¥–æ—Å—Ç–∏–≥–ª–∏ –≤—ã—Å–æ—Ç—ã –±–æ–ª–µ–µ 1000 —Ñ—É—Ç–æ–≤. –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.'''
print(dat[(dat['type'] == "hill") & (dat['climb'] > 1000)])
print(dat[(dat['type'] == "hill") & (dat['climb'] > 1000)].shape[0])

'''–í—ã–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –ª–∏–±–æ –¥–æ—Å—Ç–∏–≥–ª–∏ –≤—ã—Å–æ—Ç—ã –±–æ–ª–µ–µ 4000 —Ñ—É—Ç–æ–≤, –ª–∏–±–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ –º–µ–Ω–µ–µ 0.5 —á–∞—Å–æ–≤.'''
print(dat[((dat['time'] < 0.5) | (dat['time'] < 0.5))| (dat['climb'] > 4000)])

'''–°–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü time_min, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Ä–µ–º—è –º–∞—Ä—à—Ä—É—Ç–∞, –∏–∑–º–µ—Ä–µ–Ω–Ω–æ–µ –≤ –º–∏–Ω—É—Ç–∞—Ö.'''
dat['time_min'] = dat['time'] * 60
print(dat.head())

'''–°–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü year —Å –≥–æ–¥–æ–º —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π (–≤–µ–∑–¥–µ 2000 –≥–æ–¥). –í–Ω–∏–º–∞–Ω–∏–µ: —Å—Ç–æ–ª–±–µ—Ü —Å –≥–æ–¥–æ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–≤—ã–º (—Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º)'''
dat['year'] = 2000
print(dat.head())

#------- –î–ó –¥–æ–ø-----------
print('------- –î–ó –¥–æ–ø-----------')
'''–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–µ–±–Ω–æ–≥–æ –ø—Å–∏—Ö–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, —Ü–µ–ª—å—é –∫–æ—Ç–æ—Ä–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –≤—ã—è–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —É—Ä–æ–≤–Ω–µ–º —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏ —á–µ–ª–æ–≤–µ–∫–∞ –∏ –µ–≥–æ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç–∏ –∫ —É—á–∞—Å—Ç–∏—é –≤ –≤–æ–ª–æ–Ω—Ç—ë—Ä—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –î–∞—Ç–∞—Ñ—Ä–µ–π–º —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã:

sex: –ø–æ–ª —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞ (–ñ–µ–Ω—Å–∫–∏–π, –ú—É–∂—Å–∫–æ–π);
volunteer: —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ —É—á–∞—Å—Ç–∏–µ –≤ –≤–æ–ª–æ–Ω—Ç—ë—Ä—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–î–∞, –ù–µ—Ç);
Q 1 - Q 57: –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∞–Ω–∫–µ—Ç–µ –ê–π–∑–µ–Ω–∫–∞ (–î–∞, –ù–µ—Ç), –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–Ω–∫–µ—Ç–µ –∏ —Å–∞–º–∏ –≤–æ–ø—Ä–æ—Å—ã –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.'''

ps = pd.read_csv("extraversion.csv", encoding="UTF-8")
print(ps.head())

'''–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å–∫–æ–ª—å–∫–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤. –ü—Ä–∏–≤–µ—Å—Ç–∏ –∫–æ–¥ –∏ —É–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ –∫–æ–¥—É.'''
print(ps.shape)

'''–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã Q 1-Q 57 –≤ Q1-Q57, –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, —É–±—Ä–∞—Ç—å –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –ø—Ä–æ–±–µ–ª—ã –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ (–µ—Å–ª–∏ –µ—Å—Ç—å).'''
cols = ps.columns.tolist()
cols = [item.replace(' ', '') if item.startswith('Q') else item for item in cols ]
print(cols)
ps.columns = cols
print(ps.head())

'''–í—ã–±—Ä–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã Q1, Q3, Q8, Q10, Q13, Q17, Q22, Q25, Q27, Q39, Q44, Q46, Q49, Q53, Q56 –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º extra_yes.
–í—ã–±—Ä–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã Q5, Q15, Q20, Q29, Q32, Q34, Q37,Q41, Q51 –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º extra_no.
–≠—Ç–∏ —Å—Ç–æ–ª–±—Ü—ã –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞ —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏.'''

extra_yes = ps.loc[:, ['Q1', 'Q3', 'Q8', 'Q10', 'Q13', 'Q17', 'Q22', 'Q25', 'Q27', 'Q39', 'Q44', 'Q46', 'Q49', 'Q53', 'Q56']]
print(extra_yes.head())
extra_no = ps.loc[:, ['Q5', 'Q15', 'Q20', 'Q29', 'Q32', 'Q34', 'Q37', 'Q41', 'Q51']]
print(extra_no.head())

'''–ü–æ—Å—á–∏—Ç–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ extra_yes —á–∏—Å–ª–æ –æ—Ç–≤–µ—Ç–æ–≤ "–î–∞" –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é extra_yes_sum. 
–ü–æ—Å—á–∏—Ç–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ extra_no —á–∏—Å–ª–æ –æ—Ç–≤–µ—Ç–æ–≤ "–ù–µ—Ç" –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é extra_no_sum.'''
extra_yes_sum = extra_yes.isin(['–î–∞']).sum(axis=1)
print(extra_yes_sum)

extra_no_sum = extra_no.isin(['–ù–µ—Ç']).sum(axis=1)
print(extra_no_sum)

'''–î–æ–±–∞–≤–∏—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å—Ç–æ–ª–±–µ—Ü extra, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–Ω–¥–µ–∫—Å —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ç–∞–∫: 
—Å—É–º–º–∞ —á–∏—Å–ª–∞ –æ—Ç–≤–µ—Ç–æ–≤ "–î–∞" –≤ extra_yes –∏ —á–∏—Å–ª–∞ –æ—Ç–≤–µ—Ç–æ–≤ "–ù–µ—Ç" –≤ extra_no.'''
ps['extra'] = extra_yes_sum + extra_no_sum
print(ps.head())

'''–î–æ–±–∞–≤–∏—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å—Ç–æ–ª–±–µ—Ü female, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –∑–Ω–∞—á–µ–Ω–∏–π 0 –∏ 1 (0 ‚Äî –ú—É–∂—Å–∫–æ–π, 1 ‚Äî –ñ–µ–Ω—Å–∫–∏–π).
–ü–æ–¥—Å–∫–∞–∑–∫–∞: –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –º–µ—Ç–æ–¥ .astype() –¥–ª—è Series –≤ pandas, –æ–Ω –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ç–∏–ø—ã —Å—Ç–æ–ª–±—Ü–æ–≤.'''
ps['female'] = [1 if item == '–ñ–µ–Ω—Å–∫–∏–π' else 0 for item in ps['sex']]
print(ps.head())

'''–í—ã–±—Ä–∞—Ç—å –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ª–∏–±–æ –≤–æ–ª–æ–Ω—Ç—ë—Ä–∞–º —Å –∏–Ω–¥–µ–∫—Å–æ–º —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏ –≤—ã—à–µ 15, 
–ª–∏–±–æ –Ω–µ-–≤–æ–ª–æ–Ω—Ç—ë—Ä–∞–º —Å –∏–Ω–¥–µ–∫—Å–æ–º —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏ –Ω–∏–∂–µ 15. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º pure.'''
pure = ps[((ps['volunteer'] == '–î–∞') & (ps['extra'] > 15)) | ((ps['volunteer'] == '–ù–µ—Ç') & (ps['extra'] < 15))]
print(pure.head())

'''–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å (–ª—é–±—ã–º —Å–ø–æ—Å–æ–±–æ–º, –∫—Ä–æ–º–µ —è–≤–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞), —Å–∫–æ–ª—å–∫–æ –≤–æ–ª–æ–Ω—Ç—ë—Ä–æ–≤ –∏ –Ω–µ-–≤–æ–ª–æ–Ω—Ç—ë—Ä–æ–≤ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ pure.'''
print(pure[(pure['volunteer'] == '–î–∞')].shape[0])
print(pure[(pure['volunteer'] == '–ù–µ—Ç')].shape[0])

'''–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ, —Å—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ pure. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–∏—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 4).

–î–æ–±–∞–≤–∏—Ç—å –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º pure —Å—Ç–æ–ª–±–µ—Ü high, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ 0 –∏ 1, –≥–¥–µ 1 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞–º, —É—Ä–æ–≤–µ–Ω—å —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏—è  ùëö=max{median,mean}, 
—Ç–æ –µ—Å—Ç—å –º–∞–∫—Å–∏–º—É–º–∞ –∏–∑ –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∞ 0 ‚Äî —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞–º —Å —É—Ä–æ–≤–Ω–µ–º —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏–∏ –Ω–µ –≤—ã—à–µ  ùëö.'''

min = pure['extra'].min()
max = pure['extra'].max()
mean = pure['extra'].mean()
median = pure['extra'].median()
print(f'min: {min}, max: {max}, mean: {mean}, median: {median},')

m = np.max([median, mean])

pure['high'] = [1 if item > m else 0 for item in pure['extra']]
print(pure)
